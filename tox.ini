[tox]
envlist = py38,py39,py310,py311,py312,lint,format
skipsdist = True

[testenv]
deps =
    pytest>=7.0.0
    pytest-cov>=4.0.0
    streamlit>=1.31.0
commands =
    pytest tests/ -v --cov=. --cov-report=term-missing --cov-report=html

[testenv:lint]
deps =
    flake8>=6.0.0
    pylint>=2.17.0
    mypy>=1.0.0
    streamlit>=1.31.0
commands =
    flake8 streamlit_app.py --max-line-length=120
    pylint streamlit_app.py --disable=C0111,R0903
    mypy streamlit_app.py --ignore-missing-imports

[testenv:format]
deps =
    black>=23.0.0
    isort>=5.12.0
commands =
    black --check streamlit_app.py
    isort --check-only streamlit_app.py

[testenv:format-fix]
deps =
    black>=23.0.0
    isort>=5.12.0
commands =
    black streamlit_app.py
    isort streamlit_app.py

[testenv:security]
deps =
    bandit>=1.7.0
    safety>=2.3.0
commands =
    bandit -r streamlit_app.py
    safety check

[testenv:run]
deps =
    streamlit>=1.31.0
commands =
    streamlit run streamlit_app.py

[flake8]
max-line-length = 120
exclude = .tox,venv,build,dist
ignore = E203,W503

[pytest]
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*

[coverage:run]
omit =
    */tests/*
    */venv/*
    */.tox/*
